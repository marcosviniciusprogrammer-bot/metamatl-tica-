<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MetamatlÃ©tica â€” Jogo da MemÃ³ria v3.15</title>
  <style>
    :root{
      --bg:#060917;--bg2:#0a1030;--panel:#0c1331;--card:#0e163c;
      --muted:#a7b0c7;--text:#f2f6ff;--accent:#7aa2ff;
      --radius:24px;--shadow:0 18px 50px rgba(0,0,0,.55)
    }
    *{box-sizing:border-box}
    body{
      margin:0;height:100%;display:flex;align-items:center;justify-content:center;
      font-family:Inter,ui-sans-serif,system-ui;background:linear-gradient(180deg,var(--bg),var(--bg2));color:var(--text);padding:22px
    }
    .app{width:min(1150px,100%)}
    .glass{background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.15);backdrop-filter:blur(12px);border-radius:var(--radius);box-shadow:var(--shadow)}
    .wrap{padding:20px}
    .btn{background:rgba(20,28,80,.85);border:1px solid #2a3a7a;color:var(--text);
      padding:14px 16px;border-radius:16px;font-weight:800;cursor:pointer;
      transition:.2s transform ease,.2s box-shadow ease}
    .btn:hover{transform:translateY(-2px);box-shadow:0 12px 28px rgba(90,130,255,.35)}
    .btn:active{transform:scale(.96)}
    .btn.primary{background:linear-gradient(180deg,#9ec2ff,#5b86ff);color:#0a0f1e;border:none}
    .screen{display:none}.screen.active{display:block}
    .board{display:grid;gap:14px;padding:16px;border-radius:var(--radius);background:rgba(255,255,255,.03)}
    .cols-5{grid-template-columns:repeat(5,1fr)}.cols-6{grid-template-columns:repeat(6,1fr)}
    .tile{position:relative;aspect-ratio:3/4;border:none;border-radius:20px;overflow:hidden;cursor:pointer;perspective:1000px}
    .tile-inner{position:absolute;inset:0;transform-style:preserve-3d;transition:transform .5s}
    .tile.flip .tile-inner{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;backface-visibility:hidden;border-radius:20px}
    .face.front{background:#1d2a63}.face.back{transform:rotateY(180deg);background:#2a355a}
    .emoji{font-size:40px}
    .gbar{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-bottom:12px}
    .stat{background:rgba(12,20,56,.65);padding:10px 12px;border-radius:12px;font-size:14px}
  </style>
</head>
<body>
  <div class="app">
    <!-- LOBBY -->
    <section id="screen-lobby" class="screen active">
      <div class="wrap glass">
        <h1>ğŸ® MetamatlÃ©tica â€” Jogo da MemÃ³ria</h1>
        <p>Escolha o tamanho e o tema e clique em Jogar</p>
        <div>
          <label>Tamanho</label>
          <select id="deckSize"><option value="20">20 cartas</option><option value="30">30 cartas</option></select>
        </div>
        <div>
          <label>Tema</label>
          <select id="theme"><option value="cores">Cores</option><option value="frutas">Frutas</option></select>
        </div>
        <label><input type="checkbox" id="cbPreview"> Mostrar prÃ©via de 5s</label>
        <div style="margin-top:12px">
          <button id="btnPlay" class="btn primary">ğŸš€ Jogar</button>
          <button id="btnToggleSound" class="btn">ğŸ”ˆ Som: ON</button>
        </div>
      </div>
    </section>

    <!-- GAME -->
    <section id="screen-game" class="screen">
      <div class="wrap glass">
        <div class="gbar">
          <div>
            <button class="btn" id="btnBackInGame">â† Lobby</button>
            <button class="btn" id="btnRestart">Reiniciar</button>
            <button class="btn" id="btnToggleSoundGame">ğŸ”ˆ Som: ON</button>
          </div>
          <div class="stat">â± <b id="time">00:00</b></div>
          <div class="stat">ğŸƒ <b id="moves">0</b></div>
          <div class="stat">âœ… <b id="pairs">0</b></div>
        </div>
        <div id="hint">Boa sorte! ğŸ‘€</div>
        <div id="board" class="board"></div>
      </div>
    </section>

    <!-- WIN -->
    <div class="screen" id="screen-win">
      <div class="wrap glass">
        <h2>ğŸ‘‘ VocÃª venceu!</h2>
        <div class="stat">â± <b id="wTime">00:00</b></div>
        <div class="stat">ğŸƒ <b id="wMoves">0</b></div>
        <div class="stat">âœ… <b id="wPairs">0</b></div>
        <button class="btn" id="btnPlayAgain">Jogar de novo</button>
        <button class="btn" id="btnBackFromWin">â† Lobby</button>
      </div>
    </div>
  </div>

  <script>
  const $=s=>document.querySelector(s);
  const fmtTime=s=>`${String(Math.floor(s/60)).padStart(2,'0')}:${String(s%60).padStart(2,'0')}`;
  const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a};

  // arquivos de Ã¡udio
  const CLICK_URL="audio/Click.mp3";
  const GAME_MUSIC_URL="audio/Playground-Of-The-Stars-A.mp3";

  // Ã¡udio
  const AudioFX={
    ctx:null,inited:false,master:null,musicSource:null,
    init(){if(this.inited)return;const AC=window.AudioContext||window.webkitAudioContext;this.ctx=new AC();
      this.master=this.ctx.createGain();this.master.connect(this.ctx.destination);this.master.gain.value=1;this.inited=true;},
    async playClick(){if(!this.inited)return;const a=new Audio(CLICK_URL);a.volume=0.8;await a.play();},
    async playGameMusic(){if(!this.inited)return;this.stopGameMusic();const a=new Audio(GAME_MUSIC_URL);a.loop=true;a.volume=0.4;a.play();this.musicSource=a;},
    stopGameMusic(){if(this.musicSource){this.musicSource.pause();this.musicSource=null;}},
    toggle(on){this.master.gain.value=on?1:0;}
  };

  let SOUND_ON=true;
  function setSound(on){SOUND_ON=on;AudioFX.toggle(on);
    const b1=$('#btnToggleSound');if(b1)b1.textContent=on?'ğŸ”ˆ Som: ON':'ğŸ”‡ Som: OFF';
    const b2=$('#btnToggleSoundGame');if(b2)b2.textContent=on?'ğŸ”ˆ Som: ON':'ğŸ”‡ Som: OFF';
  }

  // jogo
  let G=null,timer=null,previewTimer=null,countdownTimer=null;
  function makeDeck(size,theme){
    const pairs=Math.floor(size/2);let items=[];
    const PALETTE=['#ff7675','#74b9ff','#55efc4','#fdcb6e','#a29bfe','#ffeaa7','#81ecec','#fab1a0','#fd79a8','#00b894','#0984e3','#6c5ce7'];
    const FRUTAS=['ğŸ','ğŸŒ','ğŸ‡','ğŸ“','ğŸ','ğŸ‘','ğŸ‰','ğŸ¥','ğŸ','ğŸ’','ğŸŠ','ğŸˆ','ğŸ‹','ğŸ','ğŸ¥¥','ğŸ…'];
    if(theme==='cores'){
      items=[];
      for(let i=0;i<pairs;i++){const h=(i*25)%360;items.push({t:'cor',v:`hsl(${h},70%,55%)`});}
    }else{items=FRUTAS.slice(0,pairs).map(f=>({t:'emoji',v:f}));}
    return shuffle([...items,...items]).map((x,i)=>({id:i,key:x.v,t:x.t,matched:false}));
  }

  function newGame(size,theme){
    G={size,theme,deck:makeDeck(size,theme),first:null,second:null,lock:false,moves:0,pairs:0,sec:0};
    $('#moves').textContent='0';$('#pairs').textContent='0';$('#time').textContent='00:00';
    buildBoard();startTimer();go('game');AudioFX.playGameMusic();
    startPreview(5);
  }

  function buildBoard(){const b=$('#board');b.innerHTML='';b.className='board '+(G.size==20?'cols-5':'cols-6');
    G.deck.forEach((c,i)=>{const el=document.createElement('button');el.className='tile';el.dataset.i=i;
      const inner=document.createElement('div');inner.className='tile-inner';
      const front=document.createElement('div');front.className='face front';
      const back=document.createElement('div');back.className='face back';
      if(c.t==='cor'){back.style.background=c.key;}else{back.textContent=c.key;back.className+=' emoji';}
      inner.appendChild(front);inner.appendChild(back);el.appendChild(inner);
      el.addEventListener('click',()=>flip(i));b.appendChild(el);});}

  function startTimer(){if(timer)clearInterval(timer);timer=setInterval(()=>{G.sec++;$('#time').textContent=fmtTime(G.sec);},1000)}
  function stopTimer(){if(timer){clearInterval(timer);timer=null}}
  function clearPreviewTimers(){if(previewTimer){clearTimeout(previewTimer);previewTimer=null}if(countdownTimer){clearInterval(countdownTimer);countdownTimer=null}}

  function startPreview(seconds){
    G.lock=true;
    Array.from($('#board').children).forEach(t=>t.classList.add('flip'));
    $('#hint').textContent="Boa sorte! ğŸ‘€";
    previewTimer=setTimeout(()=>{
      Array.from($('#board').children).forEach(t=>t.classList.remove('flip'));
      G.lock=false;$('#hint').textContent="Escolha uma carta ğŸ‘€";
    },seconds*1000);
  }

  function flip(i){
    if(G.lock||G.deck[i].matched||G.first===i)return;
    const tiles=$('#board').children;
    if(G.first==null){
      tiles[i].classList.add('flip');G.first=i;$('#hint').textContent='Escolha outra carta ğŸ‘€';return;
    }
    tiles[i].classList.add('flip');G.second=i;G.lock=true;G.moves++;$('#moves').textContent=G.moves;
    const a=G.deck[G.first],b=G.deck[G.second];
    if(a.key===b.key){a.matched=b.matched=true;G.pairs++;$('#pairs').textContent=G.pairs;$('#hint').textContent='VocÃª acertou, continue! ğŸ‰';
      setTimeout(()=>{G.first=G.second=null;G.lock=false;if(G.pairs===G.deck.length/2)win();else $('#hint').textContent="Escolha uma carta ğŸ‘€";},600);}
    else{$('#hint').textContent='VocÃª errou, tente novamente! ğŸ™„';
      setTimeout(()=>{tiles[G.first].classList.remove('flip');tiles[G.second].classList.remove('flip');G.first=G.second=null;G.lock=false;$('#hint').textContent="Escolha uma carta ğŸ‘€";},900);}
  }

  function win(){stopTimer();AudioFX.stopGameMusic();go('win');
    $('#wTime').textContent=fmtTime(G.sec);$('#wMoves').textContent=G.moves;$('#wPairs').textContent=G.pairs;}

  function go(to){['lobby','game','win'].forEach(id=>$('#screen-'+id)?.classList.remove('active'));
    $('#screen-'+to)?.classList.add('active');}

  // eventos
  function addBtnClickSound(sel){document.querySelectorAll(sel).forEach(b=>b.addEventListener('click',()=>AudioFX.playClick()));}
  $('#btnPlay').onclick=()=>{AudioFX.init();setSound(SOUND_ON);newGame(+$('#deckSize').value,$('#theme').value);};
  $('#btnRestart').onclick=()=>{if(G)newGame(G.size,G.theme)};
  $('#btnBackInGame').onclick=()=>{stopTimer();AudioFX.stopGameMusic();go('lobby');};
  $('#btnPlayAgain').onclick=()=>{newGame(G.size,G.theme)};
  $('#btnBackFromWin').onclick=()=>{go('lobby');};
  $('#btnToggleSound').onclick=()=>setSound(!SOUND_ON);
  $('#btnToggleSoundGame').onclick=()=>setSound(!SOUND_ON);

  // clique sfx em TODOS os botÃµes
  addBtnClickSound("button");
  </script>
</body>
</html>


   
    

