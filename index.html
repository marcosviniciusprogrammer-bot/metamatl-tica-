<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Metamatl√©tica ‚Äî Jogo da Mem√≥ria v3.20</title>
<style>
  :root{
    --bg:#060917;--bg2:#0a1030;--panel:#0c1331;--card:#0e163c;
    --muted:#a7b0c7;--text:#f2f6ff;--accent:#7aa2ff;
    --radius:24px;--shadow:0 18px 50px rgba(0,0,0,.55)
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;min-height:100dvh;display:flex;align-items:center;justify-content:center;
    font-family:Inter,ui-sans-serif,system-ui;
    background:
      radial-gradient(1000px 700px at 5% -10%, #20307a55, transparent),
      radial-gradient(900px 700px at 110% -10%, #0f1f6a66, transparent),
      linear-gradient(180deg, var(--bg), var(--bg2));
    color:var(--text);padding:22px
  }
  .app{width:min(1150px,100%)}
  .glass{background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
    border:1px solid rgba(255,255,255,.15); backdrop-filter: blur(12px);
    border-radius:var(--radius); box-shadow:var(--shadow)}
  .wrap{padding:20px}
  header{display:flex;justify-content:space-between;align-items:flex-start;gap:14px;margin-bottom:14px}
  h1{margin:0; font-size:clamp(24px,5.2vw,44px); letter-spacing:.4px; text-shadow:0 0 10px rgba(122,162,255,.6)}
  .tag{background:rgba(122,162,255,.15); border:1px solid rgba(122,162,255,.4); padding:6px 12px; border-radius:14px;
    font-weight:700; letter-spacing:.4px; color:#d9e4ff; box-shadow:0 0 12px rgba(122,162,255,.25)}
  .muted{color:var(--muted)}
  .screen{display:none} .screen.active{display:block}

  /* LOBBY (layout antigo) */
  .hero{display:grid;grid-template-columns:1.2fr 1fr;gap:18px;align-items:stretch}
  .brand{
    padding:26px;border-radius:22px;
    background: radial-gradient(120% 120% at -10% -20%, rgba(122,162,255,.25), transparent),
                linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
    border:1px solid rgba(255,255,255,.15);
    box-shadow: 0 30px 60px rgba(12,20,56,.45), inset 0 0 40px rgba(122,162,255,.15);
  }
  .brand h2{margin:0 0 6px; font-size:clamp(22px,4.2vw,36px)}
  .brand p{margin:0; color:var(--muted)}
  .brand .btn{margin-top:12px}
  .settings{padding:20px; border-radius:22px; background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04)); border:1px solid rgba(255,255,255,.15)}
  .row{display:flex; gap:14px; flex-wrap:wrap; align-items:center}
  .col{flex:1 1 260px}
  .btn{ background:rgba(20,28,80,.85); border:1px solid #2a3a7a; color:var(--text);
    padding:14px 16px; border-radius:16px; font-weight:800; cursor:pointer;
    transition:.2s transform ease, .2s box-shadow ease }
  .btn:hover{ transform:translateY(-2px); box-shadow:0 12px 28px rgba(90,130,255,.35) }
  .btn:active{ transform:scale(.97) }
  .btn.primary{ background:linear-gradient(180deg, #9ec2ff, #5b86ff); color:#0a0f1e; border:none }
  select{ width:100%; background:#0d163d; color:#e9eeff; border:1px solid #2a355a;
    padding:12px 14px; border-radius:14px; font-weight:700; appearance:none;
    background-image:linear-gradient(45deg,transparent 50%,#9ec2ff 50%),
                     linear-gradient(135deg,#9ec2ff 50%,transparent 50%),
                     linear-gradient(#0d163d,#0d163d);
    background-position:calc(100% - 18px) calc(1em + 2px),calc(100% - 13px) calc(1em + 2px),100% 0;
    background-size:5px 5px,5px 5px,2.8em 2.8em; background-repeat:no-repeat}
  label{display:block; font-size:15px; color:var(--muted); margin:4px 2px 8px}
  .chk{display:flex; align-items:center; gap:10px; margin-top:12px; color:var(--muted); font-weight:700}
  .chk input{appearance:none;width:20px;height:20px;border-radius:6px;border:2px solid #4a6aff;background:#0d163d;display:inline-grid;place-content:center;cursor:pointer}
  .chk input:checked{background:#4a6aff}
  .chk input:after{content:"";width:10px;height:10px;border-radius:3px;background:#dfe8ff;transform:scale(0);transition:.15s}
  .chk input:checked:after{transform:scale(1)}
  .volume-lobby{display:flex;align-items:center;gap:8px;margin-top:8px}
  .slider{appearance:none;width:140px;height:8px;background:#2a3a7a;border-radius:999px;outline:none;transition:all .2s}
  .slider:hover{background:#4a6aff}
  .slider::-webkit-slider-thumb{appearance:none;width:18px;height:18px;background:#7aa2ff;border-radius:50%;cursor:pointer;box-shadow:0 0 6px #7aa2ff;transition:transform .2s}
  .slider::-webkit-slider-thumb:hover{transform:scale(1.12)}

  /* GAME HUD ‚Äúcompacto‚Äù como antes */
  .gbar{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;margin-bottom:12px}
  .leftHUD{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .rightHUD{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .stat{ background:rgba(12,20,56,.65); border:1px solid #243056; padding:10px 12px; border-radius:12px; font-size:14px }
  .board{ display:grid; gap:14px; padding:16px; border-radius:var(--radius);
    border:1px solid rgba(255,255,255,.12); background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    box-shadow:var(--shadow) }
  .cols-5{ grid-template-columns:repeat(5, 1fr)} .cols-6{ grid-template-columns:repeat(6, 1fr)}
  .tile{ position:relative; aspect-ratio:3/4; border:none; border-radius:20px; overflow:hidden; cursor:pointer;
    perspective:1000px; outline:none; box-shadow:0 10px 22px rgba(0,0,0,.4) }
  .tile-inner{ position:absolute; inset:0; transform-style:preserve-3d; transition:transform .5s cubic-bezier(.2,.8,.2,1) }
  .tile.flip .tile-inner{ transform:rotateY(180deg) }
  .face{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; backface-visibility:hidden; border-radius:20px }
  .face.front{ background:radial-gradient(120% 120% at 20% 0%, #1d2a63, #101944 70%); border:1px solid #2f3e89 }
  .face.back{ transform:rotateY(180deg); border:1px solid rgba(255,255,255,.25);
    background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)) }
  .emoji{ font-size: clamp(30px, 7vw, 54px) }
  .hint{ margin:8px 0 12px; color:#d6deff; font-weight:800; letter-spacing:.2px; text-shadow:0 0 6px rgba(122,162,255,.5) }

  /* WIN */
  .overlay{ position:fixed; inset:0; display:none; align-items:center; justify-content:center;
    backdrop-filter: blur(10px); background: rgba(6,10,24,.6) }
  .overlay.show{ display:flex }
  .win-card{ background:#0f162b; border:1px solid #2a355a; padding:28px; border-radius:20px; text-align:center; max-width:640px; box-shadow:var(--shadow) }
  .win-card h2{ margin:10px 0 } .win-card p{ margin:6px 0; color:var(--muted) }
  .win-title{ display:flex; align-items:center; justify-content:center; gap:10px; font-size:clamp(26px,4.5vw,36px); font-weight:800; letter-spacing:.3px }
  .crown{ font-size:1.2em; filter: drop-shadow(0 4px 8px rgba(0,0,0,.35)); }

  @media (max-width:640px){
    .hero{grid-template-columns:1fr}
    .leftHUD,.rightHUD{justify-content:flex-start}
  }
</style>
</head>
<body>
  <div class="app">
    <header class="wrap">
      <div>
        <h1>Metamatl√©tica ‚Äî <span class="muted">Jogo da Mem√≥ria</span></h1>
        <div class="muted">Pensamento Computacional e Design de Jogos</div>
      </div>
      <div class="tag">v3.12</div>
    </header>

    <!-- LOBBY (estilo antigo) -->
    <section id="screen-lobby" class="screen active">
      <div class="wrap glass">
        <div class="hero">
          <div class="brand">
            <h2>üéÆ Metamatl√©tica</h2>
            <p>Escolha o tamanho e o tema, depois clique em <b>Jogar</b>. M√∫sica relaxante rola no fundo üòâ</p>
            <button id="btnAbout" class="btn">‚ÑπÔ∏è O que √© Pensamento Computacional & Design de Jogos?</button>
          </div>
          <div class="settings">
            <div class="row">
              <div class="col">
                <label>Tamanho</label>
                <select id="deckSize">
                  <option value="20">20 cartas (5 √ó 4)</option>
                  <option value="30">30 cartas (6 √ó 5)</option>
                </select>
              </div>
              <div class="col">
                <label>Tema</label>
                <select id="theme">
                  <option value="cores">Cores</option>
                  <option value="frutas">Frutas</option>
                </select>
              </div>
            </div>
            <label class="chk"><input type="checkbox" id="cbPreview" checked> Mostrar pr√©via de 5s antes de come√ßar</label>

            <div class="row" style="margin-top:10px;align-items:center">
              <button id="btnPlay" class="btn primary">üöÄ Jogar</button>
              <button id="btnToggleSound" class="btn">üîà Som: ON</button>
              <div class="volume-lobby"><span>üîä</span><input id="volumeSlider" class="slider" type="range" min="0" max="100" value="70"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT (mesmo conte√∫do, s√≥ 1 bot√£o ‚ÄúVoltar ao Lobby‚Äù no fim) -->
    <section id="screen-about" class="screen">
      <div class="wrap glass">
        <h2 style="margin:8px 0">‚ÑπÔ∏è Pensamento Computacional, Design de Jogos e Matem√°tica</h2>
        <h3>Pensamento Computacional</h3>
        <ul>
          <li><b>Decomposi√ß√£o:</b> lobby, tabuleiro, turnos, vit√≥ria.</li>
          <li><b>Padr√µes:</b> pares iguais; layouts 5√ó4/6√ó5.</li>
          <li><b>Abstra√ß√£o:</b> representar cartas (tipo, valor, estado).</li>
          <li><b>Algoritmos:</b> embaralhar (Fisher‚ÄìYates), comparar, contar jogadas/pares/tempo.</li>
          <li><b>Teste & Depura√ß√£o:</b> consertar bugs (ex.: ‚Äú3 cartas viradas‚Äù).</li>
        </ul>
        <h3>Design de Jogos</h3>
        <ul>
          <li><b>Mec√¢nicas:</b> virar 2 cartas; se errar passa a vez; se acertar continua.</li>
          <li><b>Feedback:</b> anima√ß√µes + sons e m√∫sica de vit√≥ria.</li>
          <li><b>Dificuldade:</b> 20 ou 30 cartas; temas variados.</li>
          <li><b>UX:</b> textos-guia ‚ÄúEscolha uma carta‚Äù, etc.</li>
        </ul>
        <h3>Matem√°tica Envolvida</h3>
        <ul>
          <li><b>Contagem & Probabilidade:</b> chance de achar um par.</li>
          <li><b>Aritm√©tica:</b> jogadas, pares, tempo.</li>
          <li><b>Complexidade:</b> O(n) no shuffle e checagem.</li>
          <li><b>Geometria/Matrizes:</b> grade 5√ó4 ou 6√ó5.</li>
        </ul>
        <div class="row" style="margin-top:8px;justify-content:flex-start">
          <button class="btn primary" id="btnBackLobby">‚Üê Voltar ao Lobby</button>
        </div>
      </div>
    </section>

    <!-- GAME (HUD compacto) -->
    <section id="screen-game" class="screen">
      <div class="wrap glass">
        <div class="gbar">
          <div class="leftHUD">
            <button class="btn" id="btnBackInGame">‚Üê Voltar ao Lobby</button>
            <div class="stat">‚è±Ô∏è <b id="time">00:00</b></div>
          </div>
          <div class="rightHUD">
            <div class="stat">üÉè <b id="moves">0</b> jogadas</div>
            <div class="stat">‚úÖ <b id="pairs">0</b> pares</div>
            <button class="btn" id="btnRestart">Reiniciar</button>
            <button class="btn" id="btnToggleSoundGame">üîà Som: ON</button>
          </div>
        </div>
        <div class="hint" id="hint">Boa sorte! üëÄ</div>
        <div id="board" class="board"></div>
      </div>
    </section>

    <!-- WIN (overlay como antes) -->
    <div class="overlay" id="overlayWin" aria-hidden="true">
      <div class="win-card">
        <h2 class="win-title"><span class="crown">üëë</span> Voc√™ venceu! <span class="crown">üëë</span></h2>
        <div class="row" style="justify-content:center; gap:10px; margin:10px 0 6px">
          <div class="stat">‚è±Ô∏è <b id="wTime">00:00</b></div>
          <div class="stat">‚úÖ <b id="wPairs">0</b> pares</div>
          <div class="stat">üéØ <b id="wMoves">0</b> jogadas</div>
        </div>
        <p class="muted" style="margin-top:6px">Parab√©ns pelo desempenho! Continue jogando üòâ</p>
        <div style="margin-top:10px">
          <button class="btn primary" id="btnPlayAgain">Jogar de novo</button>
          <button class="btn" id="btnBackFromWin">‚Üê Voltar ao Lobby</button>
        </div>
      </div>
    </div>
  </div>

<script>
/* ===== Helpers ===== */
const $ = s => document.querySelector(s);
const fmtTime = s => `${String(Math.floor(s/60)).padStart(2,'0')}:${String(s%60).padStart(2,'0')}`;
const shuffle = a => { for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]] } return a };

/* ===== Audio ===== */
const CLICK_URL="audio/Click.mp3";
const GAME_MUSIC_URL="audio/Playground-Of-The-Stars-A.mp3";
const AudioFX = {
  inited:false, vol:0.7, music:null,
  init(){ if(this.inited) return; this.inited=true; },
  click(){ if(!this.inited) return; const a=new Audio(CLICK_URL); a.volume=this.vol; a.play().catch(()=>{}); },
  play(){ if(!this.inited) return; this.stop(); const a=new Audio(GAME_MUSIC_URL); a.loop=true; a.volume=this.vol; a.play().catch(()=>{}); this.music=a; },
  stop(){ if(this.music){ this.music.pause(); this.music=null; } },
  setVolume(v){ this.vol=v; if(this.music) this.music.volume=v; }
};
const SND_KEY='mm_sound_on', VOL_KEY='mm_vol';
let SOUND_ON = localStorage.getItem(SND_KEY)===null ? true : localStorage.getItem(SND_KEY)==='true';
let VOLUME   = localStorage.getItem(VOL_KEY) ? +localStorage.getItem(VOL_KEY) : 0.7;

function syncVolumeUI(){ const val=Math.round(VOLUME*100); if($('#volumeSlider')) $('#volumeSlider').value=val; }
function setSound(on){
  SOUND_ON=on; localStorage.setItem(SND_KEY,on?'true':'false');
  $('#btnToggleSound').textContent=on?'üîà Som: ON':'üîá Som: OFF';
  $('#btnToggleSoundGame').textContent=on?'üîà Som: ON':'üîá Som: OFF';
  AudioFX.setVolume(on?VOLUME:0);
}
function setVolumeFromSlider(v){ VOLUME=Math.max(0,Math.min(1,v)); localStorage.setItem(VOL_KEY,VOLUME); AudioFX.setVolume(SOUND_ON?VOLUME:0); syncVolumeUI(); }

/* ===== Deck ===== */
const FRUTAS=['üçé','üçå','üçá','üçì','üçç','üçë','üçâ','ü•ù','üçê','üçí','üçä','üçà','üçã','üçè','ü••','üçÖ','üçÜ','ü•ï'];
function makeDeck(size, theme){
  const pairs=Math.floor(size/2); let items=[];
  if(theme==='cores'){
    // cores √∫nicas para n pares
    for(let i=0;i<pairs;i++){ const h=(i*24)%360; items.push({t:'cor',v:`hsl(${h} 70% 55%)`}); }
  }else{
    items=FRUTAS.slice(0,pairs).map(f=>({t:'emoji',v:f}));
  }
  return shuffle([...items, ...items]).map((x,i)=>({id:i,key:x.v,t:x.t,matched:false}));
}

/* ===== Estado e telas ===== */
const screens={ lobby:$('#screen-lobby'), game:$('#screen-game'), about:$('#screen-about') };
function go(to){ Object.values(screens).forEach(s=>s.classList.remove('active')); (to==='about'?$('#screen-about'):$('#screen-'+to)).classList.add('active'); }

let G=null, timer=null, previewTimer=null, countdownTimer=null;

function buildBoard(){
  const b=$('#board'); b.innerHTML=''; b.className='board ' + (G.size==20? 'cols-5':'cols-6');
  G.deck.forEach((c,i)=>{
    const el=document.createElement('button'); el.className='tile'; el.dataset.i=i;
    const inner=document.createElement('div'); inner.className='tile-inner';
    const front=document.createElement('div'); front.className='face front';
    const back=document.createElement('div'); back.className='face back';
    if(c.t==='cor'){ back.style.background=c.key; }
    else { back.className+=' emoji'; back.textContent=c.key; }
    inner.appendChild(front); inner.appendChild(back); el.appendChild(inner);
    el.addEventListener('click', ()=>flip(i));
    b.appendChild(el);
  });
}

function startTimer(){ if(timer) clearInterval(timer); timer=setInterval(()=>{ G.sec++; $('#time').textContent=fmtTime(G.sec); },1000) }
function stopTimer(){ if(timer){ clearInterval(timer); timer=null } }
function clearPreviewTimers(){ if(previewTimer){ clearTimeout(previewTimer); previewTimer=null } if(countdownTimer){ clearInterval(countdownTimer); countdownTimer=null } }

function startPreview(seconds){
  if(!$('#cbPreview').checked){ $('#hint').textContent='Escolha uma carta üëÄ'; return; }
  G.lock = true;
  Array.from($('#board').children).forEach(t=>t.classList.add('flip'));
  let rem = seconds; $('#hint').textContent = `Boa sorte! üëÄ`;
  countdownTimer = setInterval(()=>{ if(--rem<=0){ clearInterval(countdownTimer); countdownTimer=null; } }, 1000);
  previewTimer = setTimeout(()=>{
    Array.from($('#board').children).forEach(t=>t.classList.remove('flip'));
    G.lock = false; $('#hint').textContent = 'Escolha uma carta üëÄ';
  }, seconds*1000);
}

function newGame(size, theme){
  G = { size, theme, deck:makeDeck(size, theme), first:null, second:null, lock:false, moves:0, pairs:0, sec:0 };
  $('#moves').textContent='0'; $('#pairs').textContent='0'; $('#time').textContent='00:00';
  buildBoard(); startTimer(); go('game'); AudioFX.play(); startPreview(5);
}

function flip(i){
  if(G.lock || G.deck[i].matched || G.first===i) return;
  const tiles=$('#board').children;
  if(G.first==null){
    tiles[i].classList.add('flip'); G.first=i; $('#hint').textContent='Escolha outra carta üëÄ'; return;
  }
  tiles[i].classList.add('flip'); G.second=i; G.lock=true; G.moves++; $('#moves').textContent=G.moves;
  const a=G.deck[G.first], b=G.deck[G.second];
  if(a.key===b.key){
    a.matched=b.matched=true; G.pairs++; $('#pairs').textContent=G.pairs; $('#hint').textContent='Voc√™ acertou, continue! üéâ';
    setTimeout(()=>{ G.first=null; G.second=null; G.lock=false; if(G.pairs===Math.floor(G.size/2)) win(); else $('#hint').textContent='Escolha uma carta üëÄ'; }, 550);
  }else{
    $('#hint').textContent='Voc√™ errou, tente novamente! üôÑ';
    setTimeout(()=>{ tiles[G.first].classList.remove('flip'); tiles[G.second].classList.remove('flip'); G.first=null; G.second=null; G.lock=false; $('#hint').textContent='Escolha uma carta üëÄ'; }, 850);
  }
}

function win(){
  stopTimer(); AudioFX.stop();
  $('#wTime').textContent  = fmtTime(G.sec);
  $('#wMoves').textContent = G.moves;
  $('#wPairs').textContent = G.pairs;
  const ov=$('#overlayWin'); ov.classList.add('show'); ov.setAttribute('aria-hidden','false');
}

/* ===== Navega√ß√£o / Bot√µes ===== */
function wireClickSfx(){ document.querySelectorAll('button').forEach(b=>{ if(b.__sfxBound) return; b.addEventListener('click',()=>AudioFX.click()); b.__sfxBound=true; }); }

$('#btnPlay').onclick = ()=>{ AudioFX.init(); setSound(SOUND_ON); newGame(+$('#deckSize').value, $('#theme').value); };
$('#btnRestart').onclick = ()=>{ if(G){ clearPreviewTimers(); newGame(G.size, G.theme) } };
$('#btnBackInGame').onclick = ()=>{ stopTimer(); clearPreviewTimers(); go('lobby'); AudioFX.play(); }; // volta pro lobby com m√∫sica
$('#btnAbout').onclick = ()=> go('about');
$('#btnBackLobby').onclick = ()=> go('lobby');

$('#btnBackFromWin').onclick = ()=>{ const ov=$('#overlayWin'); ov.classList.remove('show'); ov.setAttribute('aria-hidden','true'); go('lobby'); AudioFX.play(); };
$('#btnPlayAgain').onclick   = ()=>{ const ov=$('#overlayWin'); ov.classList.remove('show'); ov.setAttribute('aria-hidden','true'); newGame(G.size, G.theme); };

$('#btnToggleSound').onclick = ()=> setSound(!SOUND_ON);
$('#btnToggleSoundGame').onclick = ()=> setSound(!SOUND_ON);

$('#volumeSlider').oninput = e => setVolumeFromSlider(e.target.value/100);

/* ===== Init + autoplay com fallback ===== */
window.addEventListener('load', ()=>{
  AudioFX.init(); AudioFX.setVolume(SOUND_ON?VOLUME:0); syncVolumeUI(); setSound(SOUND_ON);
  wireClickSfx();
  try{ AudioFX.play(); }catch(_){}
  document.addEventListener('click', ()=>{ if(!AudioFX.music) AudioFX.play(); }, {once:true});
});
</script>
</body>
</html>



   
    

